---
jupyter:
  jupytext:
    text_representation:
      extension: .Rmd
      format_name: rmarkdown
      format_version: '1.1'
      jupytext_version: 1.1.3
  kernelspec:
    display_name: Python 3
    language: python
    name: python3
---

```{python}
import sqlite3
import pandas as pd
conn = sqlite3.connect("factbook.db")
```

```{python}
q = "SELECT * FROM sqlite_master WHERE type='table';"
pd.read_sql_query(q, conn)
```

```{python}
pd.read_sql_query("SELECT * FROM facts LIMIT 5", conn)
```

```{python}
pd.read_sql_query("SELECT MIN(population), name FROM facts", conn)
```

```{python}
pd.read_sql_query("SELECT MAX(population), name FROM facts", conn)
```

```{python}
pd.read_sql_query("SELECT MIN(population_growth), name FROM facts", conn)
```

```{python}
pd.read_sql_query("SELECT MAX(population_growth), name FROM facts", conn)
```

```{python}
pd.read_sql_query("SELECT name FROM facts WHERE population = 0", conn)
```

```{python}
pd.read_sql_query("SELECT name FROM facts WHERE population = 7256490011", conn)
```

```{python}
import matplotlib.pyplot as plt
import seaborn as sns
# %matplotlib inline
```

```{python}
fig = plt.figure(figsize=(10,10))
ax = fig.add_subplot(111)

q6 = '''
select population, population_growth, birth_rate, death_rate
from facts
where population != (select max(population) from facts)
and population != (select min(population) from facts);
'''
pd.read_sql_query(q6, conn).hist(ax = ax)
```

```{python}
pd.read_sql_query('''
SELECT name, cast(population as float) / cast(area_land as float) as density
from facts ORDER BY density DESC
''', conn)
```

```{python}
pd.read_sql_query('''
select cast(population as float) / cast(area_land as float) from facts
where population != (select max(population) from facts ) and
population != (select min(population) from facts)
''', conn).hist()
```

```{python}
pd.read_sql_query('''
select name, cast(area_water as float)/cast(area as float) ratio_water
from facts
order by ratio_water desc
limit 5
''', conn)
```

```{python}
pd.read_sql_query('''
select name, cast(area_land as float)/cast(area as float) ratio_earth
from facts
order by ratio_earth desc
limit 5
''', conn)
```

```{python}
pd.read_sql_query('''
select name, area_land, area_water
from facts
where area_water > area_land
''', conn)
```
